<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Crop Yield App</title>
<link rel="stylesheet" href="agriculture.css">

<!-- Firebase SDK -->
<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { getAuth } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";
    
    // Your web app's Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyBMUzH42cgZnCrmrSI4Yq6rE2eBJSXT-1U",
        authDomain: "cropprediction-d5e5b.firebaseapp.com",
        projectId: "cropprediction-d5e5b",
        storageBucket: "cropprediction-d5e5b.firebasestorage.app",
        messagingSenderId: "340506066069",
        appId: "1:340506066069:web:c9206997bd9f7d1a44ef9c",
        measurementId: "G-97KXT84D2T"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    
    // Make auth available globally
    window.auth = auth;
    
    // Import and make Firebase functions available globally
    import { signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";
    import { getFirestore, collection, query, where, getDocs, updateDoc, doc } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";
    
    window.signInWithEmailAndPassword = signInWithEmailAndPassword;
    window.onAuthStateChanged = onAuthStateChanged;
    window.signOut = signOut;
    window.getFirestore = getFirestore;
    window.collection = collection;
    window.query = query;
    window.where = where;
    window.getDocs = getDocs;
    window.updateDoc = updateDoc;
    window.doc = doc;
</script>
</head>
<body>
  <button class="back-btn" id="backButton" aria-label="Go back">&#8592;</button>
  <nav class="navbar">
    <div class="navbar-content">
      <img src="logo.jpeg" alt="Logo" class="navbar-logo">
      <ul>
        <li><a href="#about">About</a></li>
        <li><a href="#login">Login</a></li>
        <li><a href="#help">Help</a></li>
      </ul>
    </div>
  </nav>
  <div class="box" id="loginBox">
    <form id="loginForm">
      <h2 data-i18n="login">Login</h2>
      <input id="username" required placeholder="Username" data-i18n-placeholder="username">
      <input id="password" type="password" required placeholder="Password" data-i18n-placeholder="password" pattern="^(?=.*[A-Z])(?=.*\d).{8,}$" title="Password must be at least 8 characters, include an uppercase letter and a number.">
      <button type="submit" data-i18n="login">Login</button>
    </form>
  </div>
  <div class="box" id="languageBox" style="display:none;">
    <label data-i18n="select_language">Select Language:</label>
    <select id="languageSelect">
      <option value="en">English</option>
      <option value="hi">हिंदी</option>
      <option value="or">ଓଡିଆ</option>
    </select>
    <button onclick="showLocation()" data-i18n="next">Next</button>
  </div>
  <div class="box" id="locationBox" style="display:none;">
    <h2 data-i18n="location">Enter Location</h2>
    <input id="district" placeholder="District" data-i18n-placeholder="district">
    <input id="state" placeholder="State" data-i18n-placeholder="state">
    <button type="button" onclick="fillGPS()" data-i18n="gps_location">Get GPS Location</button>
    <input id="latitude" placeholder="Latitude" readonly data-i18n-placeholder="latitude">
    <input id="longitude" placeholder="Longitude" readonly data-i18n-placeholder="longitude">
    <button onclick="showLab()" data-i18n="next">Next</button>
  </div>
  <div class="box" id="labBox" style="display:none;">
    <h2 data-i18n="lab_report">Lab Test Report</h2>
    <form id="labForm">
      <input id="nmg" placeholder="N_mg_kg" required data-i18n-placeholder="nmg">
      <input id="pmg" placeholder="P_mg_kg" required data-i18n-placeholder="pmg">
      <input id="kmg" placeholder="K_mg_kg" required data-i18n-placeholder="kmg">
      <input id="ph" placeholder="pH" required data-i18n-placeholder="ph">
      <input id="bmg" placeholder="B_mg_kg" required data-i18n-placeholder="bmg">
      <input id="znmg" placeholder="Zn_mg_kg" required data-i18n-placeholder="znmg">
      <input id="mnmg" placeholder="Mn_mg_kg" required data-i18n-placeholder="mnmg">
      <input id="mgmg" placeholder="Mg_mg_kg" required data-i18n-placeholder="mgmg">
      <input id="cumg" placeholder="Cu_mg_kg" required data-i18n-placeholder="cumg">
      <input id="femg" placeholder="Fe_mg_kg" required data-i18n-placeholder="femg">
      <input id="smg" placeholder="S_mg_kg" required data-i18n-placeholder="smg">
      <input id="ecds" placeholder="EC_ds_m" required data-i18n-placeholder="ecds">
      <button type="submit" data-i18n="submit" onclick="handleLabSubmit(event)" id="submitBtn">Submit</button>
    </form>
  </div>
  <div class="results-container" id="resultBox" style="display:none;">
  <button type="button" onclick="backToLab()" class="back-btn">← Back</button>
  <h2 class="result-title">Result Overview</h2>
  <p style="text-align:center;">Color changes accordingly: <b style="color:red;">red</b> or <b style="color:green;">green</b></p>
  
  <div class="box-row">
    <div class="result-box" id="uv-plastic">
      <div class="result-label">Uv plastic protection</div>
      <div class="result-value" id="uv-value">Required</div>
    </div>
    <div class="result-box" id="water-sprinkle">
      <div class="result-label">Water sprinkle</div>
      <div class="result-value" id="water-value">On</div>
    </div>
  </div>

  <div class="box-row">
    <div class="result-box" id="yield-before">
      Yield % before
      <div class="result-value" id="yield-before-value">60%</div>
    </div>
    <div class="result-box large" id="fertilizer-req">
      Fertilizer req
      <div class="result-value" id="fertilizer-value">N: 120kg<br>P: 45kg<br>K: 33kg</div>
    </div>
    <div class="result-box" id="yield-after">
      Yield % after
      <div class="result-value" id="yield-after-value">80%</div>
    </div>
  </div>
</div>

  <script src="agriculture.js"></script>
</body>
</html>